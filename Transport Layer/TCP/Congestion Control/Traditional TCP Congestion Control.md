-----
### TCP 혼잡 제어
-----
1. TCP는 각기 다른 호스트에서 동작하는 두 프로세스 사이의 신뢰적인 전송 서비스 제공
2. IP 계층은 네트워크 혼잡에 종단 시스템에게 어떠한 직접적 피드백도 제공하지 않으므로, '전통적인' TCP는 네트워크 지원 혼잡 제어보다 종단 간 혼잡 제어 사용

-----
### 전통적인 TCP 혼잡 제어
-----
1. TCP가 취한 접근 방식 : 네트워크 혼잡에 따라 연결에 트래픽을 보내는 전송률을 각 송신자가 제한
   - 만약 TCP 송신자가 자신과 목적지 간 경로에서 혼잡이 없음을 감지하면 송신자는 송신율을 높임
   - 반면, 송신자가 경로 사이 혼잡을 감지하면 송신자는 송신율을 줄임

2. TCP 송신자가 연결로 트래픽을 보내는 전송률을 제한하는 방법
   - TCP 연결 양 끝 각 호스트는 수신 버퍼와 송신 버퍼, 몇 가지 변수(LastByteRead, rwnd 등)로 구성
   - 송신 측에서는 TCP 혼잡 제어 메커니즘은 혼잡 윈도(Congestion Window)를 추적
     + TCP 송신자가 네트워크로 트래픽을 전송할 수 있는 속도에 제약을 가함
     + 특히, 송신하는 쪽에서 확인 응답이 안 된 데이터의 양은 cwnd와 rwnd의 최솟값을 초과하지 않을 것
```
LastByteSent - LastByReadAcked ≤ min{cwnd, rwnd}
```

  - 혼잡 제어에 집중하기 위해 수신 윈도의 제약을 무시할 수 있을 정도의 TCP 수신 버퍼가 매우 크다고 가정
  - 송신자의 확인 응답이 안 된 데이터의 양은 cwnd에 의해 한정되며, 송신자가 항상 보낼 데이터가 있다고 가정하므로, 혼잡 윈도의 모든 세그먼트는 전송
  - 이 제약은 송신자에서 확인 응답이 안 된 데이터 크기를 제한하고, 그에 따라 송신자의 송신 속도를 간접 제한
  - 대략 매 왕복 시간(RTT)의 시작 때, 송신자는 제약 조건에 따라 cwnd 바이트만큼 전송할 수 있고, RTT가 끝나는 시점에 데이터에 대한 확인응답을 수신
    + 따라서, 송신자의 송신 속도는 대략 cwnd / RTT 바이트 / 초이며, cwnd의 값을 조절해, 송신자는 링크에 데이터를 전송하는 속도 조절 가능

3. TCP 송신자가 자신과 목적지 사이 경로에 혼잡이 존재하는지를 감지
   - 타임아웃 또는 수신자로부터 3개의 중복된 ACK 수신이 발생했을 때, TCP 송신자 측에 손실 이벤트(Loss Event)가 발생했다고 정의
   - 과도한 혼잡이 발생하면, 경로에 있는 하나 이상 라우터 버퍼들이 오버플로우되고, 그 결과 TCP가 포함된 데이터그램이 버려짐
   - 버려진 데이터그램은 송신 측에서 손실 이벤트(타임아웃 또는 3개의 중복된 ACK 수신)를 발생시키고, 송신자는 송신자와 수신자 사이 경로상 혼잡이 발생했음을 알게 됨

4. 손실 이베트가 발생하지 않는 네트워크가 혼잡이 없는 경우가 되는 경우
   - 이전 확인응답이 안 된 세그먼트들에 대한 확인 응답들이 TCP 송신자에게 수신될 것
   - TCP는 혼잡 윈도 크기와 이것의 전송률을 증가시킥 위해 확인 응답을 사용할 것
   - 확인 응답이 상대적으로 낮은 속도(예) 종단 간 경로가 높은 지연을 갖거나 낮은 대역폭 링크 포함)로 도착한다면, 혼잡 윈도는 상대적으로 낮은 속도로 증가
   - 확인 응답이 높은 속도로 도착한다면, 혼잡 윈도는 더 빨리 증가
   - TCP는 확인 응답을 혼잡 윈도 크기의 증가를 유발하는 트리거(Trigger) 또는 클록(Clock)으로 사용하므로, TCP는 자체 클로킹(Self-Clocking)

5. TCP 송신자의 자신 송신 속도 결정
   - 만약 전체 TCP 송신자들이 너무 빠르게 송신하면, 네트워크가 혼잡해져 혼잡 붕괴가 나타남
   - TCP 버전은 초기 TCP 버전에서 관측된 인터넷 혼잡 붕괴에 대응하여 개발
   - TCP 송신자들이 너무 조심스럽고 천천히 송신한다면, 네트워크 내 대역폭 충분히 활용 불가
   - 즉, TCP 송신자들은 네트워크를 혼잡시키지 않고 더 높은 전송률로 보낼 수 있음

6. TCP의 처리 원칙
   - 손실된 세그먼트는 혼잡을 의미하며, 이에 따라 TCP 전송률은 한 세그먼트를 손실했을 때 줄여야 함
     + 타임아웃 이벤트나 4개의 확인 응답(하나의 ACK와 3개의 중복된 ACK) 수신은 손실 세그먼트의 재전송을 야기함
     + 혼잡 제어 관점에서 문제는 TCP 송신자가 혼잡 윈도 크기와 이에 따른 추론된 손실 이벤트에 대응하는 전송률을 줄이는 방법

   - 확인응답된 세그먼트는 네트워크가 송신자의 세그먼트를 수신자에게 전송한다는 것이며, 이에 따라 이전 확인응답되지 않은 세그먼트에 대해 ACK가 도착하면 송신자의 전송률은 증가할 수 있음
     + 확인 응답 도착은 세그먼트들이 수신자까지 성공적으로 전송되었고, 네트워크는 혼잡하지 않다는 것
     + 즉, 모든 것이 좋다는 묵시적 표시로 받아들여지므로, 혼잡 윈도 크기가 증가할 수 있음

   - 대역폭 탐색
     + 혼잡이 없는 출발지에서 목적지까지 경로를 표시하는 ACK와 혼잡한 경로를 표시하는 손실 이벤트가 주어지면, TCP 전송률을 조정하는 TCP 전략 : TCP 송신자로 하여금 손실 이벤트가 발생할 때 까지는 ACK가 도착함에 다라 전송률을 증가, 손실 이벤트가 발생한 시점에서는 전송률을 줄이는 것
     + TCP 송신자는 혼잡이 발생하는 시점까지 전송률 증가(전송률 탐색), 그 시점 이후부터는 줄인 후, 다시 혼잡 시작이 발생했는지 보기 위한 탐색 시작
     + 네트워크에 의한 혼잡 상태의 어떠한 명시적 신호가 없으며(ACK, 손실 이벤트는 묵시적 신호), 각 TCP 송신자들은 다른 TCP 송신자들과 비동기적으로 로컬 정보에 근거해 동작

7. TCP 혼잡 제어 알고리즘
   - TCP 혼잡 제어에 대한 알고리즘으로, 슬로 스타트(Slow Start), 혼잡 회피(Congestion Avoidance), 빠른 회복(Fast Recovery) 중요 요소를 가짐
   - 슬로 스타트와 혼잡 회피는 TCP의 필수 요소
   - 다만, 수신된 ACK에 대응 하여 cwnd 크기를 얼마나 증가시키는지가 서로 다름
   - 빠른 회복은 권고되지만, TCP 송신자들에게 필수 사항은 아님
