<img width="1985" height="1244" alt="image" src="https://github.com/user-attachments/assets/513acc7e-20e1-41ab-9d7e-4f995a7a49f5" />-----
### 네트워크 지연 명시적 혼잡 알림과 지연 기반 혼잡 제어
-----
1. 1980년대 후반 슬로 스타트와 혼잡 회피의 초기 표준화 이후 TCP는 종단 끝 혼잡 제어 형식을 구현
2. TCP 송신자는 네트워크에서 명시적인 혼잡 표시를 수신하지 않는 대신, 관찰된 패킷 손실을 통해 혼잡 추론
3. 최근에는 네트워크가 TCP 송신자와 수신자에게 명시적으로 혼잡 신호를 보낼 수 있도록 IP 및 TCP에 대한 확장이 제안, 구현 및 배포

-----
### 명시적 혼잡 알림 (Explicit Congestion Notification, ECN)
-----
1. 인터넷 내에서 수행되는 네트워크 지원 혼잡 제어의 한 형태로 TCP와 IP가 모두 관련되어 있음
2. 네트워크 계층에서 IP 데이터그램 헤더의 서비스 유형(Type of Service) 필드에 있는 2비트(전체적으로 4개의 가능한 값 포함)가 ECN에 사용
3. ECN 비트의 한 설정은 라우터가 정체를 겪고 있음을 나타내기 위해 라우터에서 사용
   - 혼잡 표시는 표시된 IP 데이터 그램에서 목적지 호스트로 전달되어 송신 호스트에게 전달
<div align="center">
<img src="https://github.com/user-attachments/assets/cd4f8825-1b32-463d-9049-334d2fb8f9bd">
</div>

  - RFC 3168은 언제 라우터가 혼잡해지는가는 정의하지 않고, 그 결정은 라우터 공급업체가 가능하게 하고, 네트워크 운영자가 결정하는 구성 결정
  - 직관적으로 손실이 발생하기 전 혼잡 시작을 송신자에게 알리기 위해 혼잡 알림 비트를 설정할 수 있음
  - ECN 비트의 두 번째 설정은 발신 호스트가 라우터에게 송신자와 수신자가 ECN을 사용할 수 있음을 알리고, 이에 따라 ECN으로 표시된 네트워크 혼잡에 대한 응답으로 조치를 취할 수 있음을 알리는데 사용

  - 수신 호스트의 TCP가 수신 데이터 그램을 통해 ECN 혼잡 알림 표시를 수신하면 수신 호스트의 TCP는 수신자-송신자 TCP ACK 세그먼트의 ECE(Explicit Congestion Notification Echo, 명시적 혼잡 알림 에코) 비트를 설정하여 송신 호스트의 TCP에게 혼잡 표시를 알림
  - TCP 송신자는 빠른 재전송을 사용하여 손실된 세그먼트에 반응하는 것 처럼 혼잡 윈도를 반으로 줄여 혼잡 알림 표시가 있는 ACK에 반응하고, 다음 전송되는 TCP 수신자 세그먼트 헤더에 CWR(Congestion Window Reduced) 비트를 1로 설정
  - TCP 외에 다른 트랜스포트 계층 프로토콜들도 네트워크 계층 ECN을 사용
    + 데이터그램 혼잡 제어 프로토콜(Datagram Congestion Control Protocol, DCCP)은 ECN을 활용하여 적은 오버헤드, 혼잡 제어되는 UDP와 같은 신뢰할 수 없는 서비스를 제공
    + 데이터 센터 네트워크 전용으로 설계된 데이터 센터 TCP 및 데이터 센터 정량화된 혼잡 알림도 ECN을 사용

-----
### 지연 기반 혼잡 제어
-----
1. 혼잡해지는 라우터는 그 라우터에서 버퍼가 가득 차서 패킷들이 삭제되기 전 송신자에게 혼잡 시작을 알리는 혼잡 알림 비트 설정 가능
   - 송신자는 이를 통해 패킷 손실 이전 더 일찍 전송 속도를 줄일 수 있으므로 패킷 손실 및 재전송을 피할 수 있게 됨
2. 지연 기반 접근 방식은 패킷 손실이 발생하기 전 혼잡 시작을 사전에 감지
3. TCP 베가스(TCP Vegas)
   - 모든 확인 응답된 패킷에 대한 출발지에서 목적지까지의 경로의 RTT를 측정
   - $RTT_{min}$ : 송신자에서 측정한 RTT 값 중 최솟값
     + 경로가 정체되지 않고 패킷이 최소 대기 지연을 경험할 때 발생
   - TCP 베가스의 혼잡 윈도 크기가 cwnd일 때, 혼잡하지 않을 때 처리율은 cwnd / $RTT_{min}$
   - 실제 송신자가 측정한 처리량이 이 값에 가까우면 아직 정체되지 않으므로, TCP 전송 속도가 증가할 수 있음
   - 실제 송신자가 측정한 처리량이 혼잡하지 않을 때 처리율보다 현저히 낮으면 경로가 혼잡하고 TCP 베가스 송신자는 전송 속도를 낮추게 됨
   - 즉, TCP 송신자가 파이프를 가득 채우되, 그 이상 채우지 않도록 해야 한다는 원칙하에 작동

4. BBR 혼잡 제어 프로토콜
   - TCP 베가스의 아이디어를 기반으로 작동
   - BBR를 채택하지 않은 TCP와 공정하게 경쟁할 수 있는 메커니즘 통합

5. 그 밖의 지연 기반 TCP 혼잡 제어 프로토콜 : 데이터 선터용 네트워크용 TIMELY, 복합 TCP 등 존재
