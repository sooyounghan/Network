-----
### IKE(Internet Key Exchange) : IPsec에서 키 관리
-----
1. VPN이 적은 수의 종단(예) 단지 2개의 라우터만 존재)만을 가지면, 네트워크 관리자는 SAD에 직접 SA 정보(암호화 / 인증 알고리즘 및 키 / SPI 등) 입력 가능
2. 그러나 수백 혹은 수천 개의 IPsec 라우터와 호스트로 이루어진 큰 VPN에서는 직접 입력 방법은 제한 : IKE 프로토콜 이용
3. IKE는 SSL의 핸드세이크와 유사점이 존재
   - 각 IPsec 개체는 그 개체가 공개키가 포함된 인증서를 가짐
   - SSL에서와 마찬가지로 IKE 프로토콜은 두 개체가 인증서를 교환하고 인증과 암호화 알고리즘에 대해 협상을 하게 하며, IPsec SA 세션키를 생성하기 위한 중요 자료를 안전하게 교환할 수 있게 함
   - SSL와 다른 점은 IKE는 이런 작업을 위해 두 단계를 거침

4. 상황) R1과 R2 2개의 라우터가 있음
   - 첫 번째 메세지 교환 시에서 R1과 R2가 메세지 쌍을 두 번 교환
     + 첫 번째 메세지 교환 시에는 양측이 라우터 사이의 양방향 IKE SA를 설립하기 위해 디피-헬만 알고리즘을 사용
     + IKE SA는 IPsec SA와 완전히 다르며, IKE SA는 두 라우터 사이에 인증되고 있는 암호화된 채널을 제공
     + 이 첫번째 메세지 쌍을 교환하는 동안 IKE SA의 암호화와 인증을 위한 키가 설립
     + 또한, 두 번째 단계에서 IPsec SA 키를 계산하기 위해 사용될 주 비밀키도 만들어짐
     + 첫 번쨰 단계에서는 RSA 공개키와 비밀키가 사용되지 않음
     + 특히 R1와 R2 누구도 비밀키로 서명함으로써 자신의 신분을 드러내지 않음

   - 두 번째 단계 메세지 교환 단계에서 양측이 각 방향으로 하나씩 SA를 설립
     + 마칠 때는 2개의 SA에 대한 암호화 및 인증 세션키가 양측에 만들어져 있음
     + 이후 양측은 보안 처리된 데이터그램을 보내기 위해 SA를 사용

5. IKE에 두 단계를 두게 된 이유는 연산 비용 때문
   - 두 번째 단계에서 어떠한 공개키 알고리즘도 포함하지 않으므로, IKE는 상대적으로 낮은 비용으로 두 IPsec 개체 사이 매우 많은 수의 SA 생성 가능
