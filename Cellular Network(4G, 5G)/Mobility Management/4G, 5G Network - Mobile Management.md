-----
### 4G, 5G 네트워크에서의 이동성 관리
-----
1. 차량에 탑승한 이동 사용자가 스마트폰으로 4G / 5G 방문 네트워크에 접속하여 원격 서버로부터 HD 비디오 스트리밍을 시작한 후, 하나의 4G / 5G 기지국 셀 영역으로부터 다른 셀 영역으로 이동하는 시나리오
<div align="center">
<img src="https://github.com/user-attachments/assets/742542c7-e11b-4258-9406-c36d833ff994">
</div>

   - 이동 장치와 기지국 결합 : 이동 장치는 방문 네트워크 기지국과 결합
   - 이동 장치에 대한 네트워크 요소의 제어 평면 구성 : 방문 네트워크 및 홈 네트워크는 이동 장치가 방문 네트워크에 존재함을 나타내는 제어 평면 상태를 설정
   - 이동 장치에 대한 포워딩 터널의 데이터 평면 구성 : 방문 네트워크와 홈 네트워크는 홈 네트워크의 PDN 게이트웨이를 통한 간접 라우팅을 사용하여, 이동 장치와 스트리밍 서버가 IP 데이터그램을 송수신할 수 있는 터널을 설정
   - 한 기지국에서 다른 기지국으로의 이동 장치 핸드오버 : 이동 장치는 한 기지국에서 다른 기지국으로 핸드오버를 통한 방문 네트워크 결합 지점을 변경

2. 기지국 결합
   - 이동 장치가 해당 지역의 기지국에 전송되는 기본 신호에 대해 모든 주파수 영역에서 수신함
   - 이동 장치는 점차로 이러한 기지국에 대한 더 많은 정보를 획득하여, 궁극적으로 결합할 기지국을 선택하고, 해당 기지국과 제어 신호 채널을 초기 설정
   - 이 결합의 일부로, 이동 장치는 홈 네트워크 및 다른 가입자 정보는 물론 이동 장치를 고유하게 식별하는 IMSI를 기지국에 제공

3. 이동 장치에 대한 LTE 네트워크 요소의 제어 평면 구성
   - 이동 장치와 기지국 간 신호 채널이 설정되면 기지국은 방문 네트워크의 MME와 접촉 가능
   - MME은 이동 노드를 대신해 상태를 설정하기 위해 홈 네트워크 및 방문 네트워크 모두에서 여러 가지 4G / 5G 요소들을 참조하고 구성
     + MME는 ISMI 및 이동 장치에서 제공한 다른 정보를 사용하여 해당 가입자에 대한 인증, 암호화, 가용한 네트워크 서비스 정보를 검색하며, 해당 정보는 MME 로컬 캐시에 있거나, 이동 장치가 최근에 접속한 다른 MME에서 검색되거나, 이동 장치의 홈 네트워크에 있는 HSS에서 검색될 수 있음
     + 상호 인증 프로세스는 방문 네트워크가 이동 장치의 ID에 대해 확신하고 장치가 연결 중인 네트워크를 인증할 수 있는지 확인
     + MME는 이동 장치가 현재 방문 네트워크에 존재함을 홈 네트워크에 있는 HSS에 알리고, HSS는 데이터베이스를 갱신
     + 기지국과 이동 장치는 둘 사이에 설정될 데이터 평면 채널에 대한 매개변수를 선택

4. 이동 장치에 대한 포워딩 터널의 데이터 평면 구성
<div align="center">
<img src="https://github.com/user-attachments/assets/755bd2f3-50ae-4fd8-a89d-887095be5e9c">
</div>

   - MME는 이동 장치에 대한 데이터 평면을 구성하며, 2개의 터널이 설정
   - 하나는 기지국과 방문 네트워크의 서빙 게이트웨이 사이 설립
   - 두 번째 터널은 해당 서빙 게이트웨이와 이동 장치의 홈 네트워크에 있는 PDN 게이트웨이 라우터 사이 설립
   - 4G LTE는 대칭 간접 라우팅을 구현하며, 이동 장치에서 들어오고 나가는 모든 트래픽은 장치의 홈 네트워크를 통해 터널링됨
     + 4G / 5G 터널은 GPRS 터널링 프로토콜(GTP)를 사용
     + GTP 헤더의 TEID(Tunnel Endpoint ID)는 데이터그램이 속한 터널을 나타내므로, 터널 종단점 간에 GTP에 의해 여러 개 흐름이 다중화 및 역다중화될 수 있음
   - PDN 게이트웨이(항상 이동 장치의 홈 네트워크의 PDN 게이트웨이)는 이동 장치와 다른 네트워크에 있을 수 있는데, 이는 간접 라우팅
   - 간접 라우팅 대안으로 로컬 브레이크 아웃이 존재하지만, 실제로 널리 사용되지 않음 (서빙 게이트웨이가 지역의 방문 네트워크에서 PDN 게이트웨이로의 터널 설정)
   - 터널이 구성되고 활성화되면 이동 장치는 이제 홈 네트워크의 PDN 게이트웨이를 통해 인터넷과 패킷 송수신 가능

5. 한 기지국에서 다른 기지국으로의 이동 장치 핸드오버
   - 핸드오버(HandOver) : 이동 장치가 한 기지국에서 다른 기지국으로 결합을 변경할 때 발생
   - 이동 장치가 홈 네트워크에 상주하는지 또는 방문 네트워크에서 로밍하는지 상관 없이 동일하게 적용
<div align="center">
<img src="https://github.com/user-attachments/assets/7e5c74c5-848b-4bd5-bedd-69e47ccab193">
</div>

   - 이동 장치가 송수신하는 데이터그램은 초기에, 즉 핸드오버 전 연결된 현 기지국(출발지 기지국)을 통해 이동 장치로 전달되고, 핸드오버 이후에 또 다른 기지국(목적지 기지국)을 통해 이동 장치로 라우팅
   - 기지국 간의 핸드오버는 이동 장치가 새로운 기지국과 송수신하게 될 뿐 아니라, 기지국 측면에서 서빙 게이트웨이-기지국 간 터널의 변경을 초래
   - 가장 간단한 핸드오버의 경우 : 두 기지국이 서로 가깝고 동일한 네트워크에 있을 때, 핸드 오버 결과로 발생하는 모든 변경사항은 지역적이며, 특히 서빙 게이트웨이가 사용 중인 PDN 게이트웨이는 장비의 이동성을 모르는 상태를 유지
   - 핸드오버가 발생하는 여러 이유
     + 대표적인 예는 현재 기지국과 이동 장치 신호가 통신에 심각한 장애를 줄 정도로 약화되었거나 셀이 혼잡하여 너무 많은 양의 트래픽을 처리해야 하는 경우
     + 이 경우 주변의 덜 혼잡한 셀에 이동 장치를 넘기면 혼잡을 완화할 수 있음
     + 이동 장치는 주기적으로 현재 기지국 비컨 신호와 들을 수 있는 주변 기지국 신호 특성을 측정하고, 그 결과는 이동 장치의 현 기지국(출발 기지국)에 초당 한 번 또는 두 번 보고
     + 이러한 측정 결과와 주변 셀의 이동 통신 부하 및 기타 요인에 기초해, 현재 기지국은 핸드 오버를 시작하도록 선택할 수 있음
     + 4G / 5G 표준은 핸드오버 수행 여부 또는 선택할 목적지 기지국을 결정하기 위해 기지국에서 사용할 특정 알고리즘을 지정하지 않음

   - 출발지 기지국이 이동 장치를 목적지 기지국으로 넘기기로 결정할 때 수반되는 단계
     + 현 기지국(출발지 기지국)은 목적지 기지국을 선택하고, 목적지 기지국으로 핸드오버 요청 메세지를 보냄
     + 목적지 기지국은 해당 이동 장치와 그 서비스 품질 요구사항을 지원하기 위한 충분한 자원이 있는지 확인하고, 존재한다면 해당 이동 장치를 위한 무선 접속 네트워크의 채널 자원(예) 시간 슬롯) 및 기타 자원에 미리 할당
       * 이러한 자원의 사전 할당은 이동 장치에서 오랜 시간이 소모되는 기지국 결합 프로토콜을 거치지 않도록 하여, 핸드오버가 가능한 한 빨리 실행되게 함
       * 목적지 기지국은 출발지 기지국에서 핸드오버 요청 승인 메세지로 응답하는데, 이 메세지에는 이동 장치가 새로운 기지국과 결합하는데 필요한 모든 정보가 포함

     + 출발지 기지국은 핸드오버 요청 승인 메세지를 수신하고 목적지 기지국의 ID 및 채널 접속 정보를 이동 장치에게 알려줌
       * 이 시점에서 이동 장치는 새로운 목적지 기지국과 데이터그램을 송수신하기를 시작할 수 있음
       * 이동 장치 입장에서 핸드오버가 완료된 것

     + 출발지 기지국은 데이터그램을 이동 장치로 전송하는 것을 중지하고, 대신 수신한 터널링된 데이터그램을 목적지 기지국으로 전달하며, 목적지 기지국은 이들 데이터그램을 나중에 이동 장치로 전달
     + 목적지 기지국은 MME에게 자신이 이동 장치를 서비스하는 새로운 기지국이 될 것임을 알리며, MME는 다시 서빙 게이트웨이와 목적지 기지국이 차례로 신호를 보내 이전 기지국(출발 기지국)이 아닌 새로운 기지국(목적지 기지국)에서 종료하도록 서빙 게이트웨이-기지국 터널 종단점을 재설정
     + 목적지 기지국은 터널이 재구성되었음을 이전 기지국(출발 기지국)으로 다시 확인해주어, 이전 기지국이 해당 이동 장치와 관련된 자원을 해제할 수 있도록 함
     + 이 시점에서 목적지 기지국도 이동 장치에 데이터그램 전달을 시작할 수 있으며, 재구성된 터널을 통해 새롭게 목적지 기지국으로 도착하는 데이터그램 뿐만 아니라 핸드 오버 기간에 출발지 기지국에서 목적지 기지국으로 전달된 데이터그램을 포함
       * 또한, 이동 장치로부터 외부로 나가는 데이터그램을 수신하여 이를 터널을 통해 서빙 게이트웨이로 보낼 수 있음
