-----
### 웹 캐시 (Web Cache, 프록시 서버(Proxy Server))
-----
1. 기정 웹 서버(Origin Server)를 대신하여 HTTP 요구를 충족시키는 네트워크 개체로, 자체 저장 디스크를 가지고 있어 최근 호출된 객체의 사본을 저장 및 보존
<div align="center">
<img src="https://github.com/user-attachments/assets/4e51a766-203d-4a39-af01-9f592a1bf9d7">
</div>

2. 브라우저는 사용자의 모든 HTTP 요구가 웹 캐시에 먼저 보내지도록 구성되며, 브라우저가 설정되면 객체에 대한 각 브라우저 요청은 웹 캐시에 먼저 보내지게 됨
   - 예) ```http://www.someschool.edu/campus.gif```라는 객체 요구
     + 브라우저는 웹 캐시와 TCP 연결을 설정하고, 웹 캐시에 있는 객체에 대한 HTTP 요청을 보냄
     + 웹 캐시는 객체의 사본이 자기에게 저장되어 있는지 확인하며, 저장되었다면 웹 캐시는 클라이언트 브라우저로 HTTP 응답 메세지와 함께 객체 전송
     + 만약 웹 캐시가 객체를 가지고 있지 않다면, 웹 캐시는 기점 서버인 ```www.someschool.edu```로 TCP 연결을 설정하며, 웹 캐시는 캐시와 서버 간 TCP 연결로 객체에 대한 HTTP 요청을 보내며, 요청을 받은 후 웹 캐시로 HTTP 응답 메세지와 함께 객체를 보냄
     + 웹 캐시의 객체를 수신할 때, 객체를 지역 저장장치에 복사하고 클라이언트 브라우저에 HTTP 응답 메세지와 함께 객체의 사본(클라이언트 브라우저와 웹 캐시 사이에 이미 설정된 TCP 연결을 통해) 보냄

3. 캐시는 서버이면서 클라이언트이며, 브라우저로부터 요구를 받고 응답을 보내는 것은 서버이며, 출처 서버에게 요구를 보내거나 응답을 받는 것이 클라이언트
4. 웹 캐시는 ISP가 일반적으로 구입하고 설치
5. 장점
   - 웹 캐시는 클아이언트의 요구에 대한 응답 시간을 줄여줌 (특히, 클라이언트와 기점 사이 병목 대역폭이 클라이언트와 캐시 사이 병목 대역폭에 비해 매우 작을 때 더욱 효과적)
   - 웹 캐시는 인터넷으로 접속하는 링크상의 웹 트래픽을 대폭 줄일 수 있음 (대역폭 개선이 필요가 없어지므로 비용 절감)
   - 인터넷 전체의 웹 트래픽을 실질적으로 줄임으로 모든 애플리케이션을 위한 성능 개선

<div align="center">
<img src="https://github.com/user-attachments/assets/2bbf0a30-b6b9-4de3-820f-38467d1efaac">
</div>

6. 기관 네트워크와 그 외 공중 인터넷 네트워크 예시
   - 기관 네트워크는 고속 LAN이며, 기관 네트워크에 있는 라우터와 인터넷에 있는 라우터는 15 Mbps 회선에 연결
   - 기점 서버는 인터넷에 연결되어 있지만, 전역에 걸쳐 위치
   - 평균 객체의 크기가 1 Mb이고, 기관 부라우저로부터 기점 서버에 대한 평균 요청 비율이 초당 15요청이라고 가정 (HTTP 메세지 요청이 무시할만큼 작으므로 네트워크나 접속 회선(기관 라우터에서 인터넷 라우터 사이 접속 회선)에 어떤 트래픽도 발생하지 않는다고 가정)
   - 접속 회선의 인터넷 부분 라우터 HTTP 요청(IP 데이터그램을 통햬)을 전달하고 응답을 받을 때까지 평균 소요 시간은 2초라고 가정 = 인터넷 지연
   - 총 응답시간(브라우저 요청으로부터 객체 수신까지 걸리는 시간) : LAN 지연 + 접속 지연(라우터 간의 지연), 인터넷 지연의 합
   - LAN의 트래픽 강도 : (15요청 / 초) X (1 Mb / 요청) / (100 Mbps) = 0.15
   - 접속 회선(인터넷 라우터에서 기관 라우터 사이) 트래픽 강도 : (15요청 / 초) X (1 Mb / 요청) / (15 Mbps) = 1
     + 일반적으로 LAN 트래픽 강도 0.15는 많아야 수십 ms 지연을 야기하므로 무시할 수 있음
     + 하지만 트래픽 강도가 1에 가까워지면 접속 회선의 경우 회선의 지연이 매우 커지고 한 없이 증가
     + 따라서, 요청을 만족시키기 위한 평균 응답 시간은 몇 분이 걸리므로 해결 필요
    
   - 해결 방법 : 접속률을 15 Mbps에서 100 Mbps로 늘리는 것 (많은 비용 필요)
     + 두 라우터 간 전송 지연을 무시할 수 있는 수준인 0.15까지 접속 회선의 트래픽 강도를 낮추게 되며, 이 경우 총 응답 지연(=인터넷 지연)은 2초
   - 해결 방법 : 웹 캐시 설치
     + 적중률(캐시가 만족시킨 요청 비율) : 일반적으로 0.2 ~ 0.7이지만, 여기서는 0.4라고 가정
     + 캐시가 클라이언트가 고속 LAN에 연결되어있으므로 요청의 40%는 캐시에 의해(10ms)내 만족, 60%는 기점 서버에 의해 만족되어야 함
     + 하지만, 요청된 객체의 60%만 접속 회선을 통과하므로 트래픽 강도는 1에서 0.6으로 감소
     + 일반적으로 0.8미만 트래픽 강도는 자은 지역(15 Mbps 회선에서 수십 ms)에 속하므로, 2초의 인터넷 지연에 비하면 무시 가능
     + ```(0.4) X (0.01초) + 0.6 X (2.01초) = 1.2초```
   - 웹 캐시를 설치해야 하지만, 캐시 가격은 저렴하므로 많은 캐시가 저렴한 PC에서 실행되는 공개 소프트웨어 사용

7. 콘텐츠 전송 네트워크(Content Distribution Network, CDN)
   - 사용으로, 웹 캐시는 인터넷에서 중요한 역할
   - 인터넷 전역을 통해 많은 지역적으로 분산된 캐시 설치를 통해 많은 트래픽을 지역화

-----
### 조건부 GET (Conditional GET)
-----
1. 웹 캐싱은 사용자가 느끼는 응답 시간을 줄여주지만, 캐시 내부에 있는 객체 사본이 최신화가 되지 않는 다는 문제 발생 가능 (즉, 캐싱 이후 웹 서버에 있는 객체 갱신 가능성 존재)
2. HTTP는 클라이언트가 브라우저로 전달되는 모든 객체가 최신의 것임을 확인하면서 캐싱해주는 방식 가지는데, 이를 조건부 GET
   - HTTP 요청 메세지가 GET 방식 사용
   - HTTP 요청 메세지가 ```If-modified-since: ``` 헤더 라인을 포함

3. 예시
   - 브라우저의 요청을 대신해 프록시 캐시는 요청 메세지를 웹 서버로 보냄
<div align="center">
<img src="https://github.com/user-attachments/assets/fcbcb61e-1189-477c-a723-8e08d753d66d">
</div>

   - 웹 서버는 캐시에게 객체를 가진 응답 메세지를 보냄
<div align="center">
<img src="https://github.com/user-attachments/assets/568c52e4-6875-4da3-9f4c-d4a7ea7ed73b">
</div>

   - 캐시는 요청하는 브라우저에게 객체를 보내주고, 자신에게도 객체를 저장 (중요한 점은 캐시가 객체와 더불어 마지막으로 수정된 날짜를 함께 저장)
   - 엡 서버가 수정되었으므로 브라우저는 조건부 GET으로 갱신 조사를 수행해 다음과 같은 내용 보냄
<div align="center">
<img src="https://github.com/user-attachments/assets/00d8a602-9c1e-4dfc-b929-e85079d6e89b">
</div>

   - ```If-modified-since: ```헤더 라인 값이 ```Last-Modified: ``` 헤더라인 값과 정확히 일치
   - 조건부 GET은 서버에게 그 객체가 명시된 날짜 이후 수정된 경우에만 그 객체를 보낼 것을 의미
   - 변경되지 않을 경우 다음과 같은 응답 메세지
<div align="center">
<img src="https://github.com/user-attachments/assets/364175f5-ffeb-497a-8157-c3d9df74062c">
</div>

4. 조건부 GET에 대한 응답으로 웹 서버가 여전히 응답 메세지를 보내지만, 응답 메세지에 요청된 객체를 포함하지 않을 수 있음
5. 요청 메세지에 포함하는 것은 대역폭을 낭비하는 것이고, 특히 그 개체가 크다면 사용자가 느끼는 응답 시간이 증가 (따라서, 응답 메세지를 304 Not Modified 상태 라인을 가지며, 이는 클라이언트에게 요청 객체의 캐싱된 복사본을 사용하라는 것 의미)
