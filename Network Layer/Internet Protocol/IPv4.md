-----
### 인터넷 프로토콜 버전 4 (IPv4)
-----
1. 데이터그램(Datagram) : 인터넷 네트워크 계층 패킷
2. IPv4 데이터그램 포맷
<div align="center">
<img src="https://github.com/user-attachments/assets/fb8af04c-965b-4ef0-b8bd-a69f5286e5da">
</div>

  - 버전 번호 : 4비트로 데이터그램의 IP 프로토콜 버전 명시
    + 라우터는 버전 번호를 확인 해 데이터그램의 나머지 부분을 어떻게 해석할지 결정
    + 다른 버전의 IP는 다른 데이터그램 포맷 사용
   
  - 헤더 길이 : IPv4 데이터그램은 헤더에 가변 길이 옵션을 포함하므로 IP 데이터그램에서 실제 페이로드(예를 들어, 데이터그램에 캡슐화된 트랜스포트 세그먼트)가 시작하는 곳을 결정
    + 대부분 IPv4 데이터그램은 옵션을 포함하지 않으므로 대체로 IPv4 데이터그램 헤더는 20바이트

  - 서비스 타입 : IPv4 헤더에 포함된 서비스 타입(TOS, Type Of Service) 비트는 각기 다른 유형의 IP 데이터그램 구별
    + 예를 들어, 실시간 데이터 그램(IP 전화 통신 애플리케이션)과 비실시간 트래픽(예) FTP)을 구분하는데 유용
    + 제공될 특정 서비스 레벨은 해당 라우터의 네트워크 관리자가 결정하고 구성할 정책 문제
    + TOS 비트 중 2개는 명시적 혼잡 알림에 사용

  - 데이터그램 길이 : 바이트로 계산된 IP 데이터그램(헤더와 데이터)의 전체 길이
    + 필드의 크기는 16비트이므로 IP 데이터그램 이론상 최대 길이는 65536 바이트이지만, 1500바이트보다 큰 경우는 거의 없음
    + 최대 크기의 이더넷 프레임 페이로드 필드에 IP 데이터그램 장착 가능

  - 식별자, 플래그, 단편화 오프세 : IP 단편화와 관련
    + 큰 IP 데이터그램이 여러 개 작은 IP 데이터그램으로 분할된 다음 목적지로 독립적으로 전달되며, 여기서 페이로드 데이터가 최종 호스트의 트랜스포트로 전달되기 전 다시 모이게 됨
    + IPv6은 단편화를 허용하지 않음

  - TTL(Time-To-Live) : 네트워크에서 데이터그램이 무한히 순환하지 않도록 함(라우팅 루프)
    + 라우터가 데이터그램을 처리할 떄마다 감소
    + 필드가 0이 되면 라우터가 데이터그램 폐기

  - 프로토콜 : IP 데이터그램이 최종 목적지에 도착했을때만 사용
    + 이 필드값은 IP 데이터그램에서 데이터부분이 전달될 목적지의 트랜스포트 계층의 특정 프로토콜 명시
    + 예) 값 6은 데이터 부분을 TCP로, 값 17은 UDP로 전달하라는 뜻
    + IP 데이터그램에서 프로토콜 번호 역할은 트랜스포트 게층 세그먼트에서 포트 번호 역할과 유사

  - 헤더 체크섬 : 라우터가 수신한 IP 데이터 그램의 비트 오류를 탐지하는데 도움
    + 헤더에서 각 2바이트를 수로 처리하고 이 1의 보수를 합산하여 계산
    + 인터넷 체크섬으로 알려진 이 합의 1의 보수는 체크섬 필드에 저장
    + 라우터는 수신한 각 IP 데이터그램마다 헤더 체크섬을 계산하고 이 값을 데이터그램 헤더의 체크섬과 다르면 오류 상태임을 감지
    + 라우터는 보통 오류가 검출된 데이터그램을 폐기 : TTL 필드와 옵션 필드의 값이 변경되므로 체크섬은 각 라우터에서 재계산되고 저장되어야 함
    + IP 헤더만 IP 계층에서 체크섬을 수행, TCP/UDP 체크섬은 전체 TDP/UDP 세그먼트를 계산하며, TCP/UDP와 IP는 동일한 프로토콜 스택에 속할 필요가 없음 (원리상 TCP는 IP가 아닌 다른 네트워크 프로토콜 위에서 운영될 수 있고, IP는 TCP/UDP로 전달되지 않는 데이터를 전달할 수 있음)

  - 출발지와 목적지 IP 주소
    + 출발지가 데이터그램을 생성할 때, 자신의 IP 주소를 출발지 IP 주소 필드에 삽입하고, 목적지 IP 주소를 목적지 IP 주소 필드에 삽입
    + 종종 출발지 호스트는 DNS 검색을 통해 목적지 주소를 결정할 수 있음

  - 옵션 : IP 헤더 확장
    + 모든 데이터그램 헤더 옵션 필드에 정보를 포함하지 않는 방법으로, 오버헤드를 해결하기 위해 헤더 옵션을 거의 사용하지 않음
    + 데이터그램 헤더가 가변 길이로 데이터 필드 시작점을 초기에 결정할 수 없어 옵션은 문제를 더 복잡하게 만듬
    + 일부 데이터그램은 옵션 처리 유무에 따라 라우터에서 IP 데이터그램을 처리하는데 필요한 시간이 크게 달라지므로, 이런 가변 길이 옵션은 고성능 라우터 및 호스트에서 IP 처리에 특히 중요 (따라서, IPv6에서 IP 옵션 미 포함)

  - 데이터(페이로드)
    + IP 데이터그램의 데이터 필드는 목적지에 전달하기 위해 트랜스포트 계층 세그먼트(TCP / UDP)를 포함하지만 ICMP 메세지 같은 유형의 데이터를 담기도 함

3. IP 데이터 그램은 총 20바이트의 헤더(옵션 없다고 가정)를 가지며, 데이터그램이 TCP 세그먼트를 전송한다면 단편화가 되지 않은 각 데이터그램은 애플리케이션 계층 메세지와 더불어 총 40바이트 헤더(IP 헤더 20바이트 + TCP 헤더 20바이트) 전송
