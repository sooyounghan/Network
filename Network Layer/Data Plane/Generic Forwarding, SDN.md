-----
### 일반화된 포워딩 및 소프트웨어 기반 네트워크 (SDN)
-----
1. 목적지 IP 주소를 찾은(매치) 후 패킷을 스위치 구조로 지정된 출력 포트로 전송(액션)하는 두 단계의 목적 기반 포워딩은 매치 플러스 액션 방법
   - 액션은 하나 이상 출력 포트로 패킷을 전달하고, 인터페이스에서 나가는 패킷을 로드 밸런싱(Load Balancing)하고 헤더값을 다시 쓰고, 의도적으로 패키을 차단 / 삭제 (방화벽과 같이) 및 추가 처리 작업을 위해 특수 서버로 패킷을 보내는 등 작업 수행

2. 일반화된 포워딩에서의 매치 플러스 액션 테이블 : 목적지 기반 포워딩 테이블의 개념을 일반화
   - 네트워크 계층 또는 링크 게층 그리고 포워딩 장치를 나타내는 수신지 주소들을 이용한 포워딩 결정은 3계층 라우터 또는 2계층 스위치 보다 '패킷 스위치'로 정확하게 설명
<div align="center">
<img src="Https://github.com/user-attachments/assets/9e64e4b7-a380-447e-829c-d1af86e32e42">
</div>

   - 각 패킷 스위치의 매치 플러스 액션 테이블을 보여주며, 테이블은 원격 컨트롤러를 통해 계산, 설치, 갱신됨
     + 개별 패킷 스위치 제어 구성요소는 서로 상호작용할 수 있지만, 실제로는 일반화된 매치 플러스 액션 기능이 원격 컨트롤러를 통해 구현되고 이 테이블을 계산, 설치, 갱신
   - 일반화된 포워딩에 대한 논의는 OpenFlow 기반이며, 이는 매치 플러스 액션 포워딩의 개념화 및 컨트롤러 그리고 SDN의 개념에 대한 가시적인 표준으로, 명확하고 간결한 방식으로 SDN 개념을 도입한 것이 OpenFlow 1.0

3. OpenFlow의 Flow Table(플로우 테이블)로 알려진 매치 플러스 액션 포워딩 테이블의 각 엔트리 구성 요소
   - 헤더값 세트
     + 들어오는 패킷에 대한 헤더값들의 세트
     + 목적지 기반 포워딩의 경우와 마찬가지로, 하드웨어 기반 매치는 TCAM 메모리에서 가장 신속하게 수행되며, 백만 개가 넘는 목적지 주소 동반
     + 플로우 테이블 엔트리와 매치되지 않는 패킷은 더 많은 처리를 위해 원격 컨트롤러로 전송될 수 있음
     + 실제로는 플로우 테이블은 다량 성과 또는 비용 문제를 위해 다량 플로우 테이블을 이용

   - 카운터 세트
     + 패킷들에 의해 갱신되는 카운터 세트
     + 플로우 테이블 엔트리들과 매치됨
     + 카운터는 플로우 테이블 엔트리와 마지막으로 갱신된 테이블 엔트리 이후 매치된 다수의 패킷 포함

   - 액션
     + 패킷이 플로우 테이블 엔트리와 매치될 때 여러 액션이 가능
     + 이러한 액션은 패킷을 지정된 출력 포트로 전달하고, 패킷 삭제 및 패킷 복사본을 만들어 여러 출력 포트로 보내거나 선택한 헤더 필드를 다시 쓸 수 있음

   - 플로우 테이블은 본질적으로 API이며, 개별 패킷 스위치 동작을 프로그래밍할 수 있는 개념


4. 매치
<div align="center">
<img src="https://github.com/user-attachments/assets/3dc0fd8f-974c-40e4-b158-2dadb9f71488">
</div>

   - OpenFlow 1.0 매치 플러스 액션 규칙에서 매치될 수 있는 11개의 패킷 헤더 필드와 수신 포트 ID를 보여줌
   - 패킷 스위치에 도달하는 링크 계층(2계층) 프레임은 페이로드로 네트워크 계층(3계층) 데이터그램을 포함하며, 트랜스포트 계층(4계층) 세그먼트를 포함
   - OpenFlow 매치 개념이 프로토콜의 세 계층에서 선택된 필드에 매치되도록 허용
     + 출발지 및 목적지 MAC 주소는 프레임의 송신 및 수신 인터페이스와 연관된 링크 계층 주소로, IP 주소가 아닌 이더넷 주소를 기반으로 전달함으로 OpenFlow 지원 장치가 스위치(2계층 장치) 포워딩 프레임 뿐 아니라 라우터(3계층) 포워딩 데이터그램과 동일한 성능 발휘 가능
     + 이더넷 타입 필드는 상위 계층 프로토콜, 즉 프레임의 페이로드가 역다중화되는 프로토콜(IP)에 해당
     + VLAN 필드는 가상 로컬 영역 네트워크와 관련
   - OpenFlow 1.0에서 다뤄지는 12개 값 세트들의 특정 사항은 최근 OpenFlow에서 41개로 증가
   - 진입 포트는 패킷이 수신되는 패킷 스위치의 입력 포트를 나타냄
     + 패킷의 IP 출발지 주소, IP 목적지 주소, IP 프로토콜 필드, IP 서비스 타입 필드
     + 트랜스포트 계층 출발지와 목적지 포트 번호 필드도 매치될 수 있음

   - 💡 플로우 테이블 엔트리에는 와일드 카드 사용
     + 예) ```128.119.*.*``` : ```128.119``` 주소를 첫 번째 16비트로 갖는 데아터그램의 해당 주소 필드와 매치
   - 각 플로우 테이블 엔트리는 관련 우선순위가 있는데, 여러 플로우 테이블 엔트리와 매치되면, 선별된 매치 엔트리에 해당하는 패킷이 엔트리의 가장 높은 우선순위
   - IP 헤더의 모든 필드가 매치될 수 있는 것은 아님 (예) OpenFlow에서는 TTL 필드 또는 데이터그램 길이 필드에 기반한 매치 허용하지 않는데, 이는 기능과 복잡성 간의 절충과 관련)

5. 액션
   - 각 플로우 테이블 엔트리는 플로우 테이블 엔트리와 매치되는 패킷 처리를 결정하는 0개 이상 액션 목록을 가짐
   - 포워딩(Forwarding)
     + 들어오는 패킷은 특정 실제 출력 포트로 전달되거나 모든 포트를 통해 브로드캐스팅되거나(선택 포트 제외) 선택된 포트 세트를 통해 멀티캐스트 될 수 있음
     + 패킷은 캡슐화되어 원격 컨트롤러로 전송될 수 있으며, 그런 다음 컨트롤러는 새 플로우 테이블 엔트리를 설치하고 해당 패킷에 대한 조치를 취하거나(하지 않을 수 있음) 갱신된 플로우 테이블 규칙에 따라 포워딩을 위해 패킷을 장치로 반환할 수 있음
    
   - 삭제(Dropping : 아무 액션이 없는 플로우 테이블 엔트리는 매치된 패킷을 삭제해야 함
   - 필드 수정(Modify-Field) : 패킷이 선택된 출력 포트로 전달되기 전에 10개의 패킷 헤더 필드의 값을 다시 쓸 수 있음
