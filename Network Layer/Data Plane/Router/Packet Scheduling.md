-----
### 패킷 스케줄링
-----
1. 라우터에서 일반적으로 사용되는 큐잉 처리 방법 : FCFS(First Come First Served) = FIFO(Fisrt-In First-Out)) 방식과 라운드 로빈 큐잉(Rount-Robin Queueing) 방식 사용
2. FIFO
<div align="center">
<img src="https://github.com/user-attachments/assets/6bb6897c-0b87-4e7b-baaf-8b6d3ab94e10">
</div>

  - 링크가 현재 다른 패킷을 전송 중이면 출력 링크 큐에 도착한 패킷은 전송은 기다림
  - 도착한 패킷을 담을 버퍼 공간이 충분하지 않은 경우, 도착 패킷의 공간을 확보하기 위해 큐의 폐기 정책은 패킷 손실 여부 또는 다른 패킷을 큐에서 제거할 것인지 여부를 결정할 것 (여기서는 패킷 폐기 무시)
  - 패킷이 출력되는 링크를 통해 완전히 전송되면, (즉, 서비스를 받는 경우) 큐에서 제거

  - FIFO(FCFS) 스케줄링 규칙은 출력 링크 큐에 도착한 순서와 동일한 순서로 출력 링크에서 전송할 패킷을 선택
  - 도착한 클라이언트는 대기 중인 줄 뒤쪽에서 기다리며 줄의 맨 앞으로 도착하면 서비스를 제공받음
  - 도착한 패킷은 도착한 순서를 나타내는 숫자와 함께 상단 타임라인 위에 번호가 매겨진 화살표로 표시
  - 개별 패킷의 전송은 하단 타임라인 아래 표시되며, 패킷이 전송 중에 소비하는 시간은 두 타임라인 사이 사각형으로 표시
  - 패킷이 전송되는데 세 단위 시간이 걸린다고 가정
  - FIFO에서 패킷은 도착한 순서와 동일한 순서로 나가게 됨
  - 패킷 4를 전송한 다음, 링크는 패킷 5가 도착할 때까지 유휴 상태 유지 (패킷 1에서 패킷 4까지 모두 전송되고 큐에 남아 있는 패킷이 없는 상태이기 때문임)

2. 우선순위 큐잉
   - 출력 링크에 도착한 패킷은 큐에 도착하면 우선순위 클래스로 분류
   - 네트워크 오퍼레이터는 네트워크 관리 정보를 운반하는 패킷이 사용자 트래픽보다 우선순위를 수신하도록 큐를 구성할 수 있음
   - 우선순위 클래스는 일반적으로 고유한 큐가 있으며, 전송한 패킷을 선택할 때 우선순위 큐는 전송 대기 중인 패킷으로 차 있는 상태이며, 가장 높은 우선순위 클래스에서 패킷을 전송
   - 우선순위가 동일한 패킷 중에서 선택은 전형적으로 FIFO 방식으로 행해짐

   - 우선순위 클래스가 2개인 큐 동작
<div align="center">
<img src="https://github.com/user-attachments/assets/f895de92-ba9d-4ba1-8dfe-5dddf02af96e">
</div>

   - 패킷 1, 3, 4는 높은 우선순위 클래스에 속하며 패킷 2, 5는 낮은 우선순위 클래스에 속함
   - 패킷 1이 도착하고 링크가 사용 중이지 않으면 전송을 시작
   - 패킷 1이 전송되는 중에 패킷 2와 패킷 3이 도착하고 각 우선순위가 낮은 큐에 대기
   - 패킷 1이 전송된 후 패킷 3이 패킷 2보다 먼저 전송 (패킷 3이 패킷 2보다 우선순위가 높기 때문에 이전에 도착했더라도 패킷 3이 먼저 전송)
   - 패킷 3의 전송이 끝나면 패킷 2의 전송을 시작하며, 패킷 2의 전송 중 패킷 4가 도착
   - 이 때, 패킷 4의 우선순위가 더 높더라도 비선점 우선순위 큐잉(Non-preemptive Priority Queueing)에서는 패킷이 전송이 시작되면 중단하지 않으므로 패킷 4는 전송을 위해 대기
   - 패킷 2의 전송이 종료된 이후 패킷 4의 전송이 시작

3. 라운드 로빈 큐잉
   - 패킷은 우선순위 큐잉과 같이 클래스로 분류
   - 클래스 간 엄격한 서비스 우선순위가 존재하지 않으며, 라운드 로빈 스케줄러가 클래스 간 서비스를 번갈아 제공
   - 가장 단순한 라운드 로빈 스케줄링에서는 클래스 1 패킷이 전송된 다음, 클래스 2 패킷이 전송되고, 다시 클래스 1 패킷 다음에 클래스 2 패킷이 전송
   - 작업 보존 큐잉(Work-Conserving Queueing) 규칙의 경우, 전송을 위해 기다리는 패킷이 있다면, 링크가 유휴 상태가 되는 것을 허용하지 않으므로, 클래스에서 패킷을 찾지만 아무것도 찾지 못하면 시퀀스의 다음 클래스를 즉시 검사
<div align="center">
<img src="https://github.com/user-attachments/assets/92b4c15c-39ab-4e49-9be8-fd41fb10fcc4">
</div>

   - 패킷 1, 2, 4는 클래스 1에 속하며, 패킷 3, 5는 클래스 2에 속함
   - 패킷 1은 출럭 큐에 도착하면 즉시 전송 시작
   - 패킷 1이 전송되는 동안 패킷 2와 3이 도착하고 전송 대기
   - 패킷 1의 전송이 완료되면 링크 스케줄러는 클래스 2 패킷을 찾고, 패킷 3을 전송
   - 패킷 3의 전송이 완료되면 스케줄러는 클래스 1 패킷을 찾고 패킷 2를 전송
   - 패킷 2의 전송이 완료되면 패킷 4만이 큐에 있으므로 바로 패킷 4를 전송

4. WFQ (Weighted Fair Queueing)
   - 라인드 로빈 큐잉의 일반화된 형태
   - 도착하는 패킷은 적절한 클래스별 대기 영역에서 분류되며 대기
   - 라운드 로빈 스케줄링에서처럼 WFQ 스케줄러는 순환 방식으로 동작
<div align="center">
<img src="https://github.com/user-attachments/assets/c5ffbcf2-796f-45f8-8704-caf5f483ab10">
</div>

   - 클래스가 3개 있다고 가정했을 때, 먼저 클래스 1이 동작하고 클래스 2 이후 클래스 3이 동작하는 패턴 작업 반복
   - WFQ는 작업 보존 큐잉작업 이며, 따라서 빈 클래스 큐를 찾으면 서비스 순서에서 다음 클래스로 즉시 이동
   - WFQ는 각 클래스마다 다른 양의 서비스 시간을 부여받는다는 점에서 라운드 로빈과 차이 존재
     + 특히 각 클래스 $i$는 가중치(Weight) $w_{i}$를 할당 받음
     + WFQ에서 전송할 클래스 $i$ 패킷이 있는 동안 클래스 $i$는 $w_{i} / \sum w_{j}$의 서비스 시간을 보장받으며, 분모 부분은 전송을 위해 큐에 패킷이 있는 모든 클래스의 합
     + 최악의 경우 위 대역폭만큼 사용할 수 있도록 보장 받음 (최악의 경우 : 모든 클래스의 합)
     + 따라서, 전송률 R인 링크에 대해 클래스 $i$는 항상 최소한 $R * (w_{i} / \sum w_{j})$의 처리율을 가짐
   - 여기서 설명한 WFQ는 이상적인 것 : 패킷이 이상적인 데이터 단위이며, 패킷 전송이 다른 패킷을 전송하기 위해 방해하지 않는다는 사실을 고려하지 않았음

-----
### 참고 : 망 중립성
-----
1. 패킷 스케줄링 메커니즘을 사용하여 트래픽을 클래스에 따라 다양한 수준의 서비스로 제공할 수 있음
   - 트래픽의 클래스를 정확히 구성하는 것의 정의 : ISP 결정에 달려있지만, 잠재적으로 IP 데이터그램 헤더에 있는 어떤 필드 집합이든 기반으로 할 수 있음
     + 예) IP 데이터그램 헤더의 포트 필드는 포트와 관련된 잘 알려진 서비스에 따라 데이터그램 분류하는데 사용 가능
     + ISP는 또한 잠재적으로 데이터그램의 출발지 IP 주소를 사용하여 다른 회사로부터 전송되는 데이터그램보다 우선순위 제공 가능
    
2. 망 중립성은 정확한 해석은 없지만, 다음과 같이 세 가지 명료하고 밝은 기준 규칙 제공
   - No Blocking : 광대역 인터넷에 접속 제공에 종사하는 사람 또는 서비스는 합당한 네트워크 관리에 따라 합법적 콘텐츠, 애플리케이션, 서비스 또는 비서비스 장치를 차단해서는 안 됨
   - No Throttling : 광대역 인터넷에 접속 제공에 종사하는 사람 또는 서비스는 합당한 네트워크 관리에 따라 인터넷 콘텐츠, 애플리케이션 또는 서비스 또는 해를 끼치지 않는 장치의 사용에 따라 합법적 인터넷 트래픽을 손상시키거나 저하시켜서는 안 됨
   - No Paid Prioritization : 광대역 인터넷 접속 서비스 제공에 종사하는 자는 유료 우선순위에 관여해서는 안 됨 (유료 우선순위 지정은 트래픽 형성, 우선순위 지정, 자원 예약 또는 기타 형태의 우선 트래픽 관리와 같은 기술 사용을 포함해 다른 트래픽보다 일부 트래픽을 직/간접적으로 선호하기 위한 광대역 제공자의 네트워크 관리 의미)

3. ISP의 차단, 조절 또는 유료 우선순위 제공을 금지한 이 명령은 2017년 FCC 인터넷 자유 명령 복원으로 대체되었으며, 이 금지사항은 철회되고 대신 ISP 투명성에 초점을 맞춤
