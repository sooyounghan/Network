-----
### IP 애니캐스트
-----
1. BGP는 인터넷 AS 간 라우팅 외에도 종종 DNS에서 흔히 사용되는 IP 애니캐스트 서비스를 구현하는데 사용
2. IP 애니캐스트 사용을 유도하기 위해 다음과 같은 경우 고려
   - 같은 콘텐츠를 지리적으로 분산된 다른 많은 서버에 복제
   - 각 사용자를 가장 가까운 서버의 콘텐츠로 접근하게 하려고 하는 경우

3. 예를 들어, CDN는 비디오나 그 밖의 자료가 각기 다른 나라의 서버들에 복제할 수 있으며, 마찬가지로 DNS 시스템도 DNS 정보를 전 세계 DNS 서버들에 복제할 수 있음
   - 이런 경우 어떤 사용자가 이 복제된 콘텐츠에 접근을 원할 때 사용자에게 복제된 컨텐츠를 가진 가장 가까운 서버를 알려주는 것이 바람직
   - BGP 선택 알고리즘은 매우 쉽게 자연스러운 방법 제공
<div align="center">
<img src="https://github.com/user-attachments/assets/d25f4cf3-b74d-42fd-8d3c-90767afdcf6c">
</div>

4. IP 애니캐스트 설정 단계에서 CDN 사업자가 자신의 서버 여러 대에 동일한 IP 주소를 할당하고 표준 BGP를 활용하여 이 주소를 서버 각각으로부터 알림
   - BGP 라우터가 이 IP 주소에 대한 복수 개의 경로 알림 메세지를 받으면, 이를 동일한 물리적 위치로의 서로 다른 경로에 대한 정보를 제공받고 있는 것으로 생각 (사실은 서로 다른 물리적 위치로 가는 서로 다른 경로)
   - 각 라우터는 라우팅 테이블을 설정하면서 BGP 경로 선택 알고리즘을 수행하여 해당 IP 주소로의 최고 경로 (예를 들면, AS 홉 카운트 측면에서 가장 가까운 경로)를 골라냄
   - 예를 들어, (어떤 위치로의) 한 BGP 경로가 라우터로부터 단지 한 AS 홉 길이이고 (다른 위치로의) 다른 모든 경로가 두 AS 홉 이상의 길이라면, BGP 라우터는 한 홉 떨어져 있는 위치로 패킷을 전송할 것
   - 최초의 BGP 주소 알림 단계 이후 CDN은 주된 작업인 콘텐츠 배포를 할 수 있음
   - 사용자가 비디오를 요청하면 CDN은 사용자가 어디에 위치해있든 상관없이 지리적으로 분산되어 있는 서버들이 공통적으로 사용하는 IP 주소를 사용자에게 돌려줌
   - 사용자가 그 주소로 요청을 보내면 인터넷 라우터는 그 요청 패킷을 BGP 경로 선택 알고리즘이 정의한 가장 가까운 서버로 전달

5. 하지만, 실제로 CDN은 일반적으로 IP 애니캐스트를 사용하지 않음
   - BGP 라우팅이 변경되면 하나의 TCP 연결에 속한 패킷들이 서로 다른 복제 웹 서버로 도착할 수 있기 때문임
   - 그러나 DNS 시스템에서는 DNS 질의를 가장 가까운 루트 DNS 서버로 전달하기 위해 IP 애니캐스트가 광범위하게 사용
     + 현재 13개의 루트 DNS 서버 IP 주소가 있음
     + 이들 주소 각각에 대해서 여러 개의 DNS 루트 서버가 있는데, 몇 개의 주소에 대해서는 100개도 넘는 DNS 루트 서버들이 세계 곳곳에 흩어져 존재
     + DNS 질의가 13개의 IP 주소 중 하나로 전달되면, 그 질의를 해당 IP 주소를 담당하는 DNS 루트 서버들 중 가장 가까운 서버에 전달하기 위해 IP 애니캐스트 사용
     
