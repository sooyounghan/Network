-----
### 다중 프로토콜 레이블 스위칭 (MPLS)
-----
1. 가상 회선 네트워크의 주요 개념인 고정 길이 레이블을 도입함으로써 IP 라우터의 전달 속도를 향상시키려는 목적에서 발전
2. 고정 길이 레이블과 가상 회선을 기반으로 데이터그램을 전달하기 위해 목적지 기반 IP 데이터그램 전달 인프라스트럭처를 포기하는 것이 아닌, 가능한 경우 데이터그램을 선택적으로 레이블링해서 라우터로 하여금 고정 길이 레이블(목적지 IP 주소가 아닌)을 기반으로 데이터그램을 전달할 수 있도록 목적지 IP 데이터그램 전달 하부구조를 확장하는 것
3. 중요한 것은 이 기술이 IP 주소체계와 라우팅을 사용하는 IP와 긴밀하게 동작
4. MLPS 가능 라우터에 의해 처리되는 링크 계층 프레임 형식
<div align="center">
<img src="https://github.com/user-attachments/assets/6a021b98-d546-406b-a93f-885f2dae10dc">
</div>

   - MPLS 가능 장치들 간 전달되는 링크 계층 프레임이 2계층(예) 이더넷) 헤더와 3계층(예) IP) 헤더 사이 작은 MPLS 헤더를 가짐
   - MLPS 헤더에는 레이블, 실험을 위해 예약된 3개 비트, 일련의 스택된 MPLS 헤더들의 끝을 나타내는 1개의 S비트, TTL 필드 존재
   - 💡 MLPS 향상(MLPS-enhanced) 프레임이 MPLS 가능 라우터들 사이에서만 전송 가능
     + MPLS가 가능하지 않은 라우터는 IP 헤더가 존재해야 할 곳에 MLPS 헤더를 발견하게 되면 혼란스럽기 때문임
     + MPLS 가능 라우터는 MPLS 레이블을 포워딩 테이블에서 찾아 적당한 출력 인터페이스로 데이터그램을 전달하여 MPLS 프레임을 전달하므로 종종 레이블 스위치 라우터(Label-switched Router)라고 부름
     + MPLS 가능 라우터는 목적지 IP 주소를 꺼내 볼 필요도 없으며, 포워딩 테이블에서 최장 프리픽스 대응을 찾을 필요가 없음

5. R1부터 R4까지 라우터들은 MPLS 기능이 있으며, 라우터 R5, R6은 표준 IP 라우터
<div align="center">
<img src="https://github.com/user-attachments/assets/15f67aa9-427e-449d-939c-fbae384f5143">
</div>

   - R1은 자신(R1)이 목적지 A까지 라우팅할 수 있고, MPLS 레이블 6을 포함하는 프레임을 목적지 A로 전달할 수 있음을 R2와 R3에게 광고
   - 라우터 R3은 자신이 목적지 A와 D까지 라우팅할 수 있으며, MPLS 레이블 10과 12를 포함하는 입력 프레임을 각 이들 목적지를 향해 스위칭 할 수 있음을 라우터 R4에게 광고
   - 라우터 R2는 목적지 A에 도달할 수 있고, MPLS 레이블 8을 포함하는 수신 프레임을 A로 스위칭 할 수 있음을 라우터 R4에게 광고
   - 라우터 R4는 출력 MPLS 레이블 10은 인터페이스 0, 출력 MPLS 레이블 8은 인터페이스 1을 통해 A에 도달할 수 있는 2개의 MPLS 경로를 갖게 됨
   - 스위치 랜 또는 ATM 네트워크가 IP 장치들을 연결해주는 것과 같이, IP 장치 R5, R6, A, D가 MPLS 인프라스트럭처 (MPLS 가능 라우터들 R1, R2, R3, R4)를 통해 서로 연결
   - ATM 네트워크처럼 MPLS 가능 라우터인 R1 ~ R4는 패킷의 IP 헤더를 건드리지 않고 동작

6. MPLS는 패킷의 IP 주소를 고려하지 않고 레이블을 기반으로 스위칭함
   - MPLS가 제공하는 트래픽 관리 기능
     + R4는 A로 가는 2개의 MPLS 경로를 가지며, 만약 전달이 IP 주소를 기반으로 하여 IP 계층까지 수행된다면, IP 라우팅 프로토콜은 A로의 최소 비용 경로 하나만 지정
     + 반면, MPLS는 표준 IP 라우팅 프로토콜을 사용해서는 불가능한 경로를 이용해 패킷을 전달하는 능력 제공 : MPLS를 사용한 트래픽 엔지니어링을 제공하는 간단한 하나의 방식
     + 네트워크 운영자는 일반 IP 라우팅을 배제하고 동일 목적지로 가는 트래픽의 일부는 한 경로로, 또 다른 트래픽은 다른 경로로 전달되게 할 수 있음 (정책 또는 성능 등의 다른 이유)

   - MPLS는 MPLS 전달 경로의 빠른 복구를 위해 사용 가능하며, 즉 링크 고장 시 미리 계산된 복구 경로로 트래픽을 재배정
   - 가상 사설 네트워크(Virtual Private Network, VPN)을 구현하는데 사용 가능 : 고객을 위한 VPN을 구현할 때, ISP는 MPLS 가능 네트워크를 사용해 고객의 다양한 네트워크들을 연결할 수 있음
