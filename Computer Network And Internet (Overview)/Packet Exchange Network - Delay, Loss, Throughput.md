-----
### 패킷 교환 네트워크에서 지연
-----
1. 패킷을 경로를 따라 한 노드(호스트 혹은 라우터)에서 다음 노드(호스트 호은 라우터)로 전달되므로 그 패킷은 경로상 각 노드에서 다양한 지연을 겪음
2. 중요 지연 : 노드 처리 지연(Node Processing Delay), 큐잉 지연(Queuing Delay), 전송 지연(Transmission Delay), 전파 지연(Propagation Delay) 존재
   - 이러한 지연이 쌓여서 전체 노드 지연(Total Node Delay) 발생
3. 지연 유형
<div align="center">
<img src="https://github.com/user-attachments/assets/e2aec2a7-5d32-4e88-8e20-fd0892e75394">
</div>

   - 출발지와 목적지 사이 종단 간 경로의 일부로서 한 패킷이 업 스트림 노드로부터 라우터 A를 통해 라우터 B로 보내짐
   - 라우터 A가 라우터 B에 이르는 하나의 출력(Outgoing) 링크에 가지며, 링크 앞에 큐(Queue, Buffer) 존재
   - 패킷이 업스트림 노드로부터 라우터 A에 도착하면, 라우터 A는 그 패킷에 적당한 출력 링크를 결정하기 위해 패킷 헤더를 조사하고 선택된 링크로부터 그 패킷을 보내며, 여기서는 패킷에 대한 출력 링크가 라우터 B에 이르는 링크

4. 처리 지연
   - 패킷 헤더가 조사하고 그 패킷을 어디로 보낼지 결정하는 시간
   - 처리 지연은 업스트림 노드에서 라우터 A로 패킷의 비트를 전송하면서 발생하는 패킷의 비트 레벨 오류를 조사하는 데 필요한 시간과 같은 요소를 포함할 수 있으며, 고속 라우터에서는 일반적으로 수 마이크로초
   - 이 노드 처리 후 라우터는 라우터 B에 이르는 링크에 앞선 큐를 보냄

5. 큐잉 지연
   - 패킷은 큐에서 링크를 전송되기를 기다리면서 해당 지연을 겪음
   - 특정 패킷의 큐잉 지연 길이는 큐에 저장되어 링크로 전송되기를 기다리는 앞서 도착한 패킷의 수에 의해 결정되며, 주어진 패킷의 지연은 패킷마다 상당히 다름
   - 큐가 비어 있고, 다른 패킷이 전송 중인 상태가 아니라면 이 때 패킷의 큐잉 지연은 0
   - 반면, 트래픽이 많고 다른 많은 패킷이 전송 대기 중이면 큐잉 지연은 매우 길어짐
   - 도착하는 패킷이 발견하는 이미 도착한 패킷의 수는 큐에 도착하는 트래픽의 강도와 특성에 대한 함수
   - 큐잉 지연은 수 마이크로초에서 수 밀리초에 이름

6. 전송 지연
   - 패킷이 선입 선출 방식으로 전송된다고 가정하면 인터넷에서 일반적인 것처럼 패킷은 앞서 도착한 다른 모든 패킷이 전송된 다음 전송
   - 패킷의 길이를 L비트로, 라우터 A에서 라우터 B까지의 링크의 전송률을 $R$ bps라고 하면, R은 라우터 B로 가는 링크의 전송률에 의해 결정
     + 예) 10 Mbps 이더넷 링크의 경우 전송률 R은 10 Mbps
   - 즉, 전송 지연은 L/R
   - 이는 패킷의 모든 비트를 링크로 밀어내는 데 (또는 전송하는 데) 필요한 시간으로, 일반적으로 수 마이크로초에서 수 밀리초에 해당

7. 전파 지연
   - 비트가 링크에 전해지면 라우터 B까지 전파되어야 하는데, 링크가 처음부터 라우터 B까지의 전파에 필요한 시간
   - 비트는 링크의 전파 속도로 전파되며, 전파 속도는 물리 매체(꼬임광선, 광섬유 등)에 따라 다르지만 범위는 다음과 같음 : $2 X 10^{8}$ m/s ~ $3 x 10^{8}$ m/s
     + 이는 빛의 속도와 같거나 약간 작음
   - 두 라우터 사이의 거리를 전파 속도를 나눈 것이므로, 전파 지연은 $d / s$ (d : 라우터 A와 B 사이의 거리, s는 링크의 전파 속도)
     + 패킷의 마지막 비트가 B 노드에 전파되면, 이 비트와 앞선 모든 비트는 라우터 B에 저장
   - 광역 네트워크에서 전파 지연은 일반적으로 수 밀리초에 이름

8. 💡 전송 지연과 전파 지연 비교
   - 전송 지연 : 라우터가 패킷을 보내는 데 필요한 시간 (패킷 길이와 링크 전송률의 함수이며, 두 라우터 사이의 거리와는 관계 없음)
   - 전파 지연 : 비트가 한 라우터에서 다음 라우터로 전파되는데 걸리는 시간 (두 라우터 사이의 거리에 대한 함수, 패킷 길이나 링크 전송률과 관계 없음)

9. 전체 노드 지연 계산 : $d_{total} = d_{proc} + d_{queue} + d_{trans} + d_{prop}$ ($d_{total}$ : 전체 노드 지연, $d_{proc}$ : 처리 지연, $d_{queue}$ : 큐잉 지연, $d_{trans}$ : 전송 지연, $d_{prop}$ : 전파 지연)
